(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5169fcbd"],{"1f07":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("NavigateBar",{attrs:{title:"精彩跟帖"}}),a("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了","immediate-check":!1},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e,n){return a("div",{key:n,staticClass:"comment"},[a("div",{staticClass:"comment-top"},[a("div",{staticClass:"user"},[a("img",{attrs:{src:t.$axios.defaults.baseURL+e.user.head_img}}),a("div",{staticClass:"user-info"},[a("p",[t._v(t._s(e.user.nickname))]),a("span",[t._v(t._s(t.moment(e.create_date).fromNow()))])])]),a("span",{staticClass:"reply",on:{click:function(a){return t.handleReply(e)}}},[t._v("回复")])]),e.parent?a("CommentFloor",{attrs:{data:e.parent},on:{reply:t.handleReply}}):t._e(),a("div",{staticClass:"content"},[t._v(" "+t._s(e.content)+" ")])],1)})),0),a("div",{staticClass:"publish"},[a("van-field",{ref:"textarea",staticClass:"textarea",class:t.isFocus?"ative":"",attrs:{rows:t.rows,autosize:!t.isFocus,type:"textarea",placeholder:t.reply.user?"回复：@"+t.reply.user.nickname:"说点什么..."},on:{focus:t.handleFocus,blur:t.handleBlur},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}}),t.isFocus?a("span",{staticClass:"submit",on:{click:t.handleSubmit}},[t._v("发布")]):t._e()],1)],1)},s=[],i=(a("99af"),a("498a"),a("2909")),o=a("5d70"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"comment-floor"},[t.data.parent?a("commentFloor",{attrs:{data:t.data.parent},on:{reply:t.handleReply}}):t._e(),a("div",{staticClass:"floor-top"},[a("div",{staticClass:"user"},[a("em",[t._v(t._s(t.data.user.nickname))]),a("span",[t._v(t._s(t.moment(t.data.create_date).fromNow()))])]),a("span",{staticClass:"reply",on:{click:function(e){return t.handleReply(t.data)}}},[t._v("回复")])]),a("div",{staticClass:"content"},[t._v(" "+t._s(t.data.content)+" ")])],1)])},c=[],l=a("c1df"),u=a.n(l),d={props:["data"],methods:{handleReply:function(t){this.$emit("reply",t)}},name:"commentFloor",data:function(){return{moment:u.a}}},f=d,p=(a("ea22"),a("2877")),m=Object(p["a"])(f,r,c,!1,null,"6cd2162e",null),h=m.exports;u.a.locale("zh-CN");var v={data:function(){return{pid:"",list:[],moment:u.a,loading:!1,finished:!1,pageIndex:1,pageSize:5,message:"",rows:1,isFocus:!1,reply:{}}},components:{NavigateBar:o["a"],CommentFloor:h},mounted:function(){var t=this.$route.params.id;this.pid=t,this.getList()},methods:{getList:function(){var t=this;this.$axios({url:"/post_comment/".concat(this.pid),params:{pageIndex:this.pageIndex,pageSize:this.pageSize}}).then((function(e){var a=e.data.data;t.list=[].concat(Object(i["a"])(t.list),Object(i["a"])(a)),t.pageIndex+=1,t.loading=!1,a.length<t.pageSize&&(t.finished=!0)}))},onLoad:function(){this.getList()},handleFocus:function(){this.isFocus=!0},handleBlur:function(){var t=this;setTimeout((function(){t.isFocus=!1,""===t.message.trim()&&(t.reply={})}),100)},handleSubmit:function(){var t=this;if(""!=this.message.trim()){var e=JSON.parse(localStorage.getItem("userInfo"))||{},a=e.token,n={content:this.message};this.reply.id&&(n.parent_id=this.reply.id),this.$axios({url:"/post_comment/"+this.pid,method:"post",headers:{Authorization:a},data:n}).then((function(e){t.message="",t.$toast.success("发布成功"),t.list=[],t.pageIndex=1,t.getList()}))}},handleReply:function(t){var e=this;setTimeout((function(){e.reply=t,e.isFocus=!0,e.$refs.textarea.focus()}),200)}}},g=v,_=(a("52d5"),Object(p["a"])(g,n,s,!1,null,"8c6e28c2",null));e["default"]=_.exports},2847:function(t,e,a){},"498a":function(t,e,a){"use strict";var n=a("23e7"),s=a("58a8").trim,i=a("c8d2");n({target:"String",proto:!0,forced:i("trim")},{trim:function(){return s(this)}})},"52d5":function(t,e,a){"use strict";var n=a("eb84"),s=a.n(n);s.a},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,a){var n=a("1d80"),s=a("5899"),i="["+s+"]",o=RegExp("^"+i+i+"*"),r=RegExp(i+i+"*$"),c=function(t){return function(e){var a=String(n(e));return 1&t&&(a=a.replace(o,"")),2&t&&(a=a.replace(r,"")),a}};t.exports={start:c(1),end:c(2),trim:c(3)}},"5d70":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"navigate-bar"},[a("span",{staticClass:"iconfont iconjiantou2",on:{click:function(e){return t.$router.back()}}}),a("strong",[t._v(t._s(t.title))]),t.showHome?a("span",{staticClass:"iconfont iconshouye",on:{click:function(e){return t.$router.push("/")}}}):a("span",{staticClass:"iconfont iconshouye",staticStyle:{opacity:"0"}})])},s=[],i={props:["title","showHome"]},o=i,r=(a("c22f"),a("2877")),c=Object(r["a"])(o,n,s,!1,null,"13a97b2c",null);e["a"]=c.exports},"99af":function(t,e,a){"use strict";var n=a("23e7"),s=a("d039"),i=a("e8b5"),o=a("861d"),r=a("7b0b"),c=a("50c4"),l=a("8418"),u=a("65f0"),d=a("1dde"),f=a("b622"),p=a("2d00"),m=f("isConcatSpreadable"),h=9007199254740991,v="Maximum allowed index exceeded",g=p>=51||!s((function(){var t=[];return t[m]=!1,t.concat()[0]!==t})),_=d("concat"),y=function(t){if(!o(t))return!1;var e=t[m];return void 0!==e?!!e:i(t)},b=!g||!_;n({target:"Array",proto:!0,forced:b},{concat:function(t){var e,a,n,s,i,o=r(this),d=u(o,0),f=0;for(e=-1,n=arguments.length;e<n;e++)if(i=-1===e?o:arguments[e],y(i)){if(s=c(i.length),f+s>h)throw TypeError(v);for(a=0;a<s;a++,f++)a in i&&l(d,f,i[a])}else{if(f>=h)throw TypeError(v);l(d,f++,i)}return d.length=f,d}})},c22f:function(t,e,a){"use strict";var n=a("e26a"),s=a.n(n);s.a},c8d2:function(t,e,a){var n=a("d039"),s=a("5899"),i="​᠎";t.exports=function(t){return n((function(){return!!s[t]()||i[t]()!=i||s[t].name!==t}))}},e26a:function(t,e,a){},ea22:function(t,e,a){"use strict";var n=a("2847"),s=a.n(n);s.a},eb84:function(t,e,a){}}]);
//# sourceMappingURL=chunk-5169fcbd.9799ba80.js.map